webpackJsonp([10],{IzJq:function(t,e){},J6BJ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("n12u");var r={name:"UserItem",props:{user:{type:Object,required:!0}},data:function(){return{}},computed:{isFollow:function(){var t=this.user,e=t.follower,s=void 0!==e&&e,r=t.following,a=void 0!==r&&r;return s&&a?"eachFollow":s?"follow":"unFollow"}},methods:{followUser:function(){var t=this;if(this.loading)return!1;this.loading=!0,this.$store.dispatch("FOLLOW_USER",{id:this.user.id,status:this.isFollow}).then(function(e){var s=e.follower;t.loading=!1,t.user.follower=s}).catch(function(e){var s=e.response;s=void 0===s?{}:s;var r=s.data,a=void 0===r?{message:"操作失败"}:r;t.loading=!1,t.$Message.error(a)})}}},a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-item",attrs:{id:"user-item-"+t.user.id}},[s("v-avatar",{staticClass:"user-item-avatar",attrs:{uid:t.user.id,sex:t.user.sex,src:t.user.avatar}}),s("div",{staticClass:"user-item-info"},[s("p",{staticClass:"user-item-name ellipsis"},[t._v(t._s(t.user.name))]),s("p",{staticClass:"user-item-bio ellipsis"},[t._v(t._s(t.user.bio||"这家伙很懒,什么也没留下"))])]),s("svg",{staticClass:"user-item-follow-icon",on:{click:function(e){return e.stopPropagation(),t.followUser(e)}}},[s("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#base-"+t.isFollow}})])],1)},i=[],o=s("XyMi");function n(t){s("XlaL")}var l=!1,u=n,c=null,f=null,h=Object(o["a"])(r,a,i,l,u,c,f),m=h.exports,d={name:"UserFans",components:{UserItem:m},data:function(){return{userList:[],refreshData:[]}},computed:{userID:function(){return this.$route.params.userID},type:function(){var t=this.$route.query.type;return t||"followers"}},watch:{type:function(){this.userList=[],this.$refs.loadmore.beforeRefresh()},refreshData:function(t){t.length>0&&(this.userList=Object.assign([],this.userList,t))}},methods:{navTo:function(t){return{path:"/user/".concat(this.userID,"/fans"),query:{type:t}}},onRefresh:function(){var t=this;this.refreshData=[],this.$http.get("/users/".concat(this.userID,"/").concat(this.type)).then(function(e){var s=e.data,r=void 0===s?[]:s;r.length>0&&(t.refreshData=r),t.$refs.loadmore.topEnd(!(r.length<20))})},onLoadMore:function(){var t=this;this.$http.get("/users/".concat(this.userID,"/").concat(this.type),{params:{limit:15,offset:this.userList.length}}).then(function(e){var s=e.data,r=void 0===s?[]:s;r.length>0&&(t.userList=t.userList.concat(r)),t.$refs.loadmore.bottomEnd(r.length<15)})}}},v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-fans"},[s("nav",{staticClass:"m-box m-head-top m-justify-bet m-lim-width m-pos-f m-main m-bb1"},[s("div",{staticClass:"m-box m-aln-center"},[s("svg",{staticClass:"m-style-svg m-svg-def",on:{click:t.goBack}},[s("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#base-back"}})])]),s("ul",{staticClass:"m-box m-flex-grow1 m-flex-shrink0 m-aln-center m-justify-center m-flex-base0 m-head-nav"},[s("router-link",{attrs:{tag:"li",to:t.navTo("followers"),"active-class":"active",exact:""}},[s("a",[t._v("粉丝")])]),s("router-link",{attrs:{tag:"li",to:t.navTo("followings"),"active-class":"active",exact:""}},[s("a",[t._v("关注")])])],1),s("div",{staticClass:"m-box m-justify-end"})]),s("main",{staticStyle:{"padding-top":"0.9rem"}},[s("load-more",{ref:"loadmore",staticClass:"user-fans--list",attrs:{onRefresh:t.onRefresh,onLoadMore:t.onLoadMore}},t._l(t.userList,function(e){return e.id?s("user-item",{key:"user-item-"+e.id,attrs:{user:e}}):t._e()}))],1)])},p=[];function g(t){s("IzJq")}var w=!1,b=g,x=null,y=null,k=Object(o["a"])(d,v,p,w,b,x,y);e["default"]=k.exports},XlaL:function(t,e){}});
//# sourceMappingURL=user.js.map